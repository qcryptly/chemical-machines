"""
6-31G Basis Set Data

Split-valence double-zeta basis set by Pople and coworkers.
Data from Basis Set Exchange.

References:
- Hehre, Ditchfield, Pople, J. Chem. Phys. 56, 2257 (1972)
- Hariharan, Pople, Theor. Chim. Acta 28, 213 (1973)
"""

from typing import Dict, List, Tuple
from copy import deepcopy


# Base 6-31G data: element -> {shell_label: [(coeff, exp), ...]}
# Format: (contraction coefficient, exponent)
BASIS_6_31G_DATA = {
    'H': {
        # 1s contracted from 3 primitives
        '1s': [
            (0.0334946, 18.7311370),
            (0.2347269, 2.8253944),
            (0.8137573, 0.6401217),
        ],
        # 1s' (valence, single primitive)
        '2s': [
            (1.0, 0.1612778),
        ],
    },
    'He': {
        '1s': [
            (0.0237660, 38.4216340),
            (0.1546790, 5.7780300),
            (0.4696300, 1.2417740),
        ],
        '2s': [
            (1.0, 0.2979640),
        ],
    },
    'Li': {
        '1s': [
            (0.0064260, 642.4189200),
            (0.0477890, 96.7985150),
            (0.2315350, 22.0911210),
            (0.7896630, 6.2010703),
            (0.7927390, 1.9351177),
            (0.0195520, 0.6367358),
        ],
        '2s': [
            (-0.0010340, 2.3249184),
            (-0.0049910, 0.6324306),
            (0.0022700, 0.0790534),
        ],
        '2s_outer': [
            (1.0, 0.0359620),
        ],
        '2p': [
            (0.0032160, 2.3249184),
            (0.0159190, 0.6324306),
            (0.0665620, 0.0790534),
        ],
        '2p_outer': [
            (1.0, 0.0359620),
        ],
    },
    'Be': {
        '1s': [
            (0.0019448, 1682.8000000),
            (0.0148620, 251.7150000),
            (0.0730060, 57.4116000),
            (0.2526210, 16.5171000),
            (0.7952430, 4.8536400),
            (0.2586000, 0.6268630),
        ],
        '2s': [
            (-0.1126400, 8.3093800),
            (-0.2295000, 1.7407500),
            (1.1869200, 0.4858240),
        ],
        '2s_outer': [
            (1.0, 0.1636130),
        ],
        '2p': [
            (0.0559020, 8.3093800),
            (0.2615500, 1.7407500),
            (0.7939700, 0.4858240),
        ],
        '2p_outer': [
            (1.0, 0.1636130),
        ],
    },
    'B': {
        '1s': [
            (0.0018664, 2068.8823000),
            (0.0142515, 310.6495700),
            (0.0696059, 70.6830330),
            (0.2325250, 20.2518040),
            (0.4670100, 6.5863900),
            (0.3634000, 0.9221140),
        ],
        '2s': [
            (-0.1303940, 12.0521430),
            (-0.1307870, 2.5042610),
            (1.1309440, 0.7425120),
        ],
        '2s_outer': [
            (1.0, 0.2397840),
        ],
        '2p': [
            (0.0745976, 12.0521430),
            (0.3078470, 2.5042610),
            (0.7434680, 0.7425120),
        ],
        '2p_outer': [
            (1.0, 0.2397840),
        ],
    },
    'C': {
        '1s': [
            (0.0018347, 3047.5249000),
            (0.0140373, 457.3695100),
            (0.0688426, 103.9486900),
            (0.2321844, 29.2101550),
            (0.4679413, 9.2866630),
            (0.3623120, 3.1639270),
        ],
        '2s': [
            (-0.1193324, 7.8682724),
            (-0.1608542, 1.8812885),
            (1.1434564, 0.5442493),
        ],
        '2s_outer': [
            (1.0, 0.1687144),
        ],
        '2p': [
            (0.0689991, 7.8682724),
            (0.3164240, 1.8812885),
            (0.7443083, 0.5442493),
        ],
        '2p_outer': [
            (1.0, 0.1687144),
        ],
    },
    'N': {
        '1s': [
            (0.0017650, 4173.5110000),
            (0.0135365, 627.4579000),
            (0.0668230, 142.9021000),
            (0.2286340, 40.2343300),
            (0.4688670, 12.8202100),
            (0.3600000, 4.3904370),
        ],
        '2s': [
            (-0.1149610, 11.6263580),
            (-0.1691180, 2.7162800),
            (1.1458520, 0.7722180),
        ],
        '2s_outer': [
            (1.0, 0.2120313),
        ],
        '2p': [
            (0.0675800, 11.6263580),
            (0.3239070, 2.7162800),
            (0.7408950, 0.7722180),
        ],
        '2p_outer': [
            (1.0, 0.2120313),
        ],
    },
    'O': {
        '1s': [
            (0.0018311, 5484.6717000),
            (0.0139501, 825.2349500),
            (0.0684451, 188.0469600),
            (0.2327143, 52.9645000),
            (0.4701930, 16.8975700),
            (0.3585209, 5.7996353),
        ],
        '2s': [
            (-0.1107775, 15.5396160),
            (-0.1480263, 3.5999336),
            (1.1307670, 1.0137618),
        ],
        '2s_outer': [
            (1.0, 0.2700058),
        ],
        '2p': [
            (0.0708743, 15.5396160),
            (0.3397528, 3.5999336),
            (0.7271586, 1.0137618),
        ],
        '2p_outer': [
            (1.0, 0.2700058),
        ],
    },
    'F': {
        '1s': [
            (0.0018176, 7001.7130900),
            (0.0138694, 1051.3660900),
            (0.0680272, 239.2856900),
            (0.2331762, 67.3974453),
            (0.4712295, 21.5199573),
            (0.3566327, 7.4031013),
        ],
        '2s': [
            (-0.1082040, 20.8479528),
            (-0.1467090, 4.8083083),
            (1.1287400, 1.3440700),
        ],
        '2s_outer': [
            (1.0, 0.3581514),
        ],
        '2p': [
            (0.0716167, 20.8479528),
            (0.3459121, 4.8083083),
            (0.7224699, 1.3440700),
        ],
        '2p_outer': [
            (1.0, 0.3581514),
        ],
    },
    'Ne': {
        '1s': [
            (0.0018328, 8425.8515300),
            (0.0140032, 1268.5194000),
            (0.0685954, 289.6214100),
            (0.2320380, 81.8590040),
            (0.4731020, 26.2515079),
            (0.3531590, 9.0947205),
        ],
        '2s': [
            (-0.1071830, 26.5321310),
            (-0.1461320, 6.1017550),
            (1.1277740, 1.6962710),
        ],
        '2s_outer': [
            (1.0, 0.4458187),
        ],
        '2p': [
            (0.0719095, 26.5321310),
            (0.3495133, 6.1017550),
            (0.7199405, 1.6962710),
        ],
        '2p_outer': [
            (1.0, 0.4458187),
        ],
    },
    'Na': {
        '1s': [
            (0.0016098, 9993.2000000),
            (0.0123730, 1499.8900000),
            (0.0612157, 340.9100000),
            (0.2102900, 96.4523000),
            (0.4325280, 31.1894000),
            (0.3669140, 10.8636000),
        ],
        '2s': [
            (-0.0022190, 150.9630000),
            (-0.0974330, 35.5878000),
            (-0.2144720, 11.1683000),
            (0.2949290, 3.9020100),
            (0.5803800, 1.3817700),
            (0.2567330, 0.4663820),
        ],
        '2s_outer': [
            (-0.1850000, 0.4979660),
            (-0.0817670, 0.0843530),
            (1.0740500, 0.0666350),
        ],
        '2s_outer2': [
            (1.0, 0.0259544),
        ],
        '2p': [
            (0.0068250, 150.9630000),
            (0.0493370, 35.5878000),
            (0.1688290, 11.1683000),
            (0.3584910, 3.9020100),
            (0.4520270, 1.3817700),
            (0.2256610, 0.4663820),
        ],
        '2p_outer': [
            (0.0155600, 0.4979660),
            (-0.0134780, 0.0843530),
            (1.0193200, 0.0666350),
        ],
        '2p_outer2': [
            (1.0, 0.0259544),
        ],
    },
    'Mg': {
        '1s': [
            (0.0015095, 11722.8000000),
            (0.0116120, 1759.9300000),
            (0.0576063, 400.8460000),
            (0.1990750, 113.3100000),
            (0.4143840, 36.7156000),
            (0.3709660, 12.8457000),
        ],
        '2s': [
            (-0.0002660, 189.1800000),
            (-0.0838390, 45.2119000),
            (-0.1979650, 14.3563000),
            (0.2352400, 5.1388900),
            (0.5747620, 1.9065200),
            (0.3028280, 0.7058870),
        ],
        '2s_outer': [
            (-0.2099830, 0.9293400),
            (-0.1084030, 0.2690350),
            (1.1759200, 0.1173790),
        ],
        '2s_outer2': [
            (1.0, 0.0421061),
        ],
        '2p': [
            (0.0052730, 189.1800000),
            (0.0396480, 45.2119000),
            (0.1439850, 14.3563000),
            (0.3320140, 5.1388900),
            (0.4504920, 1.9065200),
            (0.2565710, 0.7058870),
        ],
        '2p_outer': [
            (-0.0242600, 0.9293400),
            (0.0096740, 0.2690350),
            (1.0252400, 0.1173790),
        ],
        '2p_outer2': [
            (1.0, 0.0421061),
        ],
    },
    'Al': {
        '1s': [
            (0.0014090, 13983.1000000),
            (0.0108310, 2098.7500000),
            (0.0538970, 477.7050000),
            (0.1870000, 134.3600000),
            (0.3930200, 43.5107000),
            (0.3739700, 15.1892000),
        ],
        '2s': [
            (-0.0010950, 239.6680000),
            (-0.0697870, 57.4419000),
            (-0.1856800, 18.2859000),
            (0.1571600, 6.5991400),
            (0.5765000, 2.4904900),
            (0.3584500, 0.9445310),
        ],
        '2s_outer': [
            (-0.2277640, 1.2779000),
            (-0.0943400, 0.3975900),
            (1.1897900, 0.1600950),
        ],
        '2s_outer2': [
            (1.0, 0.0556577),
        ],
        '2p': [
            (0.0039390, 239.6680000),
            (0.0309800, 57.4419000),
            (0.1241800, 18.2859000),
            (0.3068200, 6.5991400),
            (0.4538200, 2.4904900),
            (0.2750100, 0.9445310),
        ],
        '2p_outer': [
            (-0.0175100, 1.2779000),
            (0.0446100, 0.3975900),
            (1.0034000, 0.1600950),
        ],
        '2p_outer2': [
            (1.0, 0.0556577),
        ],
        '3p': [
            (0.0044690, 1.2779000),
            (0.1190100, 0.3975900),
            (0.9610400, 0.1600950),
        ],
        '3p_outer': [
            (1.0, 0.0556577),
        ],
    },
    'Si': {
        '1s': [
            (0.0013199, 16115.9000000),
            (0.0101460, 2425.5800000),
            (0.0505110, 553.8670000),
            (0.1762890, 156.3400000),
            (0.3752770, 50.8686000),
            (0.3775250, 17.8282000),
        ],
        '2s': [
            (-0.0008440, 292.7180000),
            (-0.0608290, 69.8731000),
            (-0.1765400, 22.3363000),
            (0.1013700, 8.1503900),
            (0.5711800, 3.1345800),
            (0.4052000, 1.2254300),
        ],
        '2s_outer': [
            (-0.2467890, 1.7273800),
            (-0.0692520, 0.5729220),
            (1.2120400, 0.2221920),
        ],
        '2s_outer2': [
            (1.0, 0.0778369),
        ],
        '2p': [
            (0.0032780, 292.7180000),
            (0.0267740, 69.8731000),
            (0.1140840, 22.3363000),
            (0.2942880, 8.1503900),
            (0.4569980, 3.1345800),
            (0.2886590, 1.2254300),
        ],
        '2p_outer': [
            (-0.0278490, 1.7273800),
            (0.0619970, 0.5729220),
            (1.0116900, 0.2221920),
        ],
        '2p_outer2': [
            (1.0, 0.0778369),
        ],
        '3p': [
            (0.0142650, 1.7273800),
            (0.1984360, 0.5729220),
            (0.8528420, 0.2221920),
        ],
        '3p_outer': [
            (1.0, 0.0778369),
        ],
    },
    'P': {
        '1s': [
            (0.0012395, 19413.3000000),
            (0.0095310, 2909.4200000),
            (0.0474930, 661.3640000),
            (0.1665600, 185.7590000),
            (0.3572880, 60.3413000),
            (0.3793010, 21.1437000),
        ],
        '2s': [
            (-0.0006870, 339.4780000),
            (-0.0536640, 81.0101000),
            (-0.1668400, 25.8780000),
            (0.0508880, 9.4522100),
            (0.5622500, 3.6656600),
            (0.4385900, 1.4674600),
        ],
        '2s_outer': [
            (-0.2531570, 2.1562300),
            (-0.0512080, 0.7489970),
            (1.2158600, 0.2831450),
        ],
        '2s_outer2': [
            (1.0, 0.0998317),
        ],
        '2p': [
            (0.0027280, 339.4780000),
            (0.0232900, 81.0101000),
            (0.1048300, 25.8780000),
            (0.2828500, 9.4522100),
            (0.4590800, 3.6656600),
            (0.2972100, 1.4674600),
        ],
        '2p_outer': [
            (-0.0352700, 2.1562300),
            (0.0725850, 0.7489970),
            (1.0126000, 0.2831450),
        ],
        '2p_outer2': [
            (1.0, 0.0998317),
        ],
        '3p': [
            (0.0268430, 2.1562300),
            (0.2521300, 0.7489970),
            (0.8010500, 0.2831450),
        ],
        '3p_outer': [
            (1.0, 0.0998317),
        ],
    },
    'S': {
        '1s': [
            (0.0011636, 21917.1000000),
            (0.0089500, 3301.4900000),
            (0.0446280, 754.1460000),
            (0.1566350, 212.7110000),
            (0.3384650, 69.0584000),
            (0.3820790, 24.2631000),
        ],
        '2s': [
            (-0.0005430, 423.7350000),
            (-0.0473370, 100.7100000),
            (-0.1580000, 32.1599000),
            (-0.0002710, 11.8079000),
            (0.5443100, 4.6311000),
            (0.4894400, 1.8702500),
        ],
        '2s_outer': [
            (-0.2548540, 2.6158400),
            (-0.0327490, 0.9221670),
            (1.2150800, 0.3412870),
        ],
        '2s_outer2': [
            (1.0, 0.1171670),
        ],
        '2p': [
            (0.0022270, 423.7350000),
            (0.0197490, 100.7100000),
            (0.0934440, 32.1599000),
            (0.2632000, 11.8079000),
            (0.4531100, 4.6311000),
            (0.3087500, 1.8702500),
        ],
        '2p_outer': [
            (-0.0352960, 2.6158400),
            (0.0772900, 0.9221670),
            (1.0088400, 0.3412870),
        ],
        '2p_outer2': [
            (1.0, 0.1171670),
        ],
        '3p': [
            (0.0405680, 2.6158400),
            (0.2986730, 0.9221670),
            (0.7620900, 0.3412870),
        ],
        '3p_outer': [
            (1.0, 0.1171670),
        ],
    },
    'Cl': {
        '1s': [
            (0.0010960, 25180.1000000),
            (0.0084380, 3780.3500000),
            (0.0421220, 860.4740000),
            (0.1480700, 242.1450000),
            (0.3217050, 78.6349000),
            (0.3829000, 27.5996000),
        ],
        '2s': [
            (-0.0004510, 491.7650000),
            (-0.0418930, 116.8840000),
            (-0.1488700, 37.3153000),
            (-0.0402720, 13.7834000),
            (0.5384890, 5.4521500),
            (0.5191660, 2.2258800),
        ],
        '2s_outer': [
            (-0.2515260, 3.1864900),
            (-0.0178780, 1.1442900),
            (1.2095200, 0.4203770),
        ],
        '2s_outer2': [
            (1.0, 0.1426570),
        ],
        '2p': [
            (0.0018540, 491.7650000),
            (0.0170100, 116.8840000),
            (0.0843630, 37.3153000),
            (0.2468800, 13.7834000),
            (0.4499390, 5.4521500),
            (0.3231300, 2.2258800),
        ],
        '2p_outer': [
            (-0.0337950, 3.1864900),
            (0.0753380, 1.1442900),
            (1.0053400, 0.4203770),
        ],
        '2p_outer2': [
            (1.0, 0.1426570),
        ],
        '3p': [
            (0.0527890, 3.1864900),
            (0.3345530, 1.1442900),
            (0.7241500, 0.4203770),
        ],
        '3p_outer': [
            (1.0, 0.1426570),
        ],
    },
    'Ar': {
        '1s': [
            (0.0010330, 28348.3000000),
            (0.0079570, 4257.6200000),
            (0.0397720, 969.8570000),
            (0.1400680, 273.2630000),
            (0.3057270, 88.7768000),
            (0.3854790, 31.1547000),
        ],
        '2s': [
            (-0.0003790, 575.8910000),
            (-0.0373430, 136.8160000),
            (-0.1399010, 43.8098000),
            (-0.0717980, 16.2094000),
            (0.5308870, 6.4608400),
            (0.5417850, 2.6511400),
        ],
        '2s_outer': [
            (-0.2502470, 3.8602800),
            (-0.0054680, 1.4137300),
            (1.2061700, 0.5166460),
        ],
        '2s_outer2': [
            (1.0, 0.1738880),
        ],
        '2p': [
            (0.0015750, 575.8910000),
            (0.0149410, 136.8160000),
            (0.0767960, 43.8098000),
            (0.2339420, 16.2094000),
            (0.4492450, 6.4608400),
            (0.3357160, 2.6511400),
        ],
        '2p_outer': [
            (-0.0323340, 3.8602800),
            (0.0727650, 1.4137300),
            (1.0035300, 0.5166460),
        ],
        '2p_outer2': [
            (1.0, 0.1738880),
        ],
        '3p': [
            (0.0628110, 3.8602800),
            (0.3643300, 1.4137300),
            (0.6931300, 0.5166460),
        ],
        '3p_outer': [
            (1.0, 0.1738880),
        ],
    },
}


# Polarization d functions for heavy atoms (6-31G*)
POLARIZATION_D = {
    'Li': {'d': [(1.0, 0.200)]},
    'Be': {'d': [(1.0, 0.400)]},
    'B':  {'d': [(1.0, 0.600)]},
    'C':  {'d': [(1.0, 0.800)]},
    'N':  {'d': [(1.0, 0.800)]},
    'O':  {'d': [(1.0, 0.800)]},
    'F':  {'d': [(1.0, 0.800)]},
    'Ne': {'d': [(1.0, 0.800)]},
    'Na': {'d': [(1.0, 0.175)]},
    'Mg': {'d': [(1.0, 0.175)]},
    'Al': {'d': [(1.0, 0.325)]},
    'Si': {'d': [(1.0, 0.450)]},
    'P':  {'d': [(1.0, 0.550)]},
    'S':  {'d': [(1.0, 0.650)]},
    'Cl': {'d': [(1.0, 0.750)]},
    'Ar': {'d': [(1.0, 0.850)]},
}


# Polarization p functions for hydrogen (6-31G**)
POLARIZATION_P = {
    'H':  {'p': [(1.0, 1.100)]},
    'He': {'p': [(1.0, 1.100)]},
}


# Diffuse sp functions for heavy atoms (6-31+G)
DIFFUSE_SP = {
    'Li': {'s_diff': [(1.0, 0.0074000)], 'p_diff': [(1.0, 0.0074000)]},
    'Be': {'s_diff': [(1.0, 0.0207000)], 'p_diff': [(1.0, 0.0207000)]},
    'B':  {'s_diff': [(1.0, 0.0315000)], 'p_diff': [(1.0, 0.0315000)]},
    'C':  {'s_diff': [(1.0, 0.0438000)], 'p_diff': [(1.0, 0.0438000)]},
    'N':  {'s_diff': [(1.0, 0.0639000)], 'p_diff': [(1.0, 0.0639000)]},
    'O':  {'s_diff': [(1.0, 0.0845000)], 'p_diff': [(1.0, 0.0845000)]},
    'F':  {'s_diff': [(1.0, 0.1076000)], 'p_diff': [(1.0, 0.1076000)]},
    'Ne': {'s_diff': [(1.0, 0.1300000)], 'p_diff': [(1.0, 0.1300000)]},
    'Na': {'s_diff': [(1.0, 0.0076000)], 'p_diff': [(1.0, 0.0076000)]},
    'Mg': {'s_diff': [(1.0, 0.0146000)], 'p_diff': [(1.0, 0.0146000)]},
    'Al': {'s_diff': [(1.0, 0.0318000)], 'p_diff': [(1.0, 0.0318000)]},
    'Si': {'s_diff': [(1.0, 0.0331000)], 'p_diff': [(1.0, 0.0331000)]},
    'P':  {'s_diff': [(1.0, 0.0348000)], 'p_diff': [(1.0, 0.0348000)]},
    'S':  {'s_diff': [(1.0, 0.0405000)], 'p_diff': [(1.0, 0.0405000)]},
    'Cl': {'s_diff': [(1.0, 0.0483000)], 'p_diff': [(1.0, 0.0483000)]},
    'Ar': {'s_diff': [(1.0, 0.0600000)], 'p_diff': [(1.0, 0.0600000)]},
}


# Diffuse s and p functions for H and He (6-31++G)
DIFFUSE_H = {
    'H':  {'s_diff': [(1.0, 0.0360000)]},
    'He': {'s_diff': [(1.0, 0.0513800)]},
}


def get_6_31g_basis(variant: str = '6-31G') -> Dict:
    """
    Get 6-31G basis set data with specified variant.

    Args:
        variant: One of '6-31G', '6-31G*', '6-31G**', '6-31+G', '6-31+G*',
                 '6-31++G', '6-31++G**'

    Returns:
        Dictionary mapping elements to shell data
    """
    # Start with base 6-31G
    result = deepcopy(BASIS_6_31G_DATA)

    # Parse variant
    has_d_polar = '*' in variant or '(d' in variant.lower()
    has_p_polar = '**' in variant or '(d,p)' in variant.lower()
    has_diffuse_heavy = '+' in variant
    has_diffuse_h = '++' in variant

    # Add polarization d functions on heavy atoms
    if has_d_polar:
        for elem, shells in POLARIZATION_D.items():
            if elem in result:
                result[elem].update(shells)

    # Add polarization p functions on H/He
    if has_p_polar:
        for elem, shells in POLARIZATION_P.items():
            if elem in result:
                result[elem].update(shells)

    # Add diffuse functions on heavy atoms
    if has_diffuse_heavy:
        for elem, shells in DIFFUSE_SP.items():
            if elem in result:
                result[elem].update(shells)

    # Add diffuse functions on H/He
    if has_diffuse_h:
        for elem, shells in DIFFUSE_H.items():
            if elem in result:
                result[elem].update(shells)

    return result
